<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Arena Visualization · Caesar.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Caesar.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Getting Started</span><ul><li><a class="toctext" href="../../installation_environment/">Installation</a></li><li><a class="toctext" href="../../faq/">FAQ</a></li></ul></li><li><span class="toctext">Initial Concepts</span><ul><li><a class="toctext" href="../concepts/">Caesar Concepts</a></li><li><a class="toctext" href="../building_graphs/">Building Factor Graphs</a></li><li><a class="toctext" href="../available_varfacs/">Available Variables/Factors</a></li><li><a class="toctext" href="../interacting_fgs/">Interacting w/ Factor Graphs</a></li><li><a class="toctext" href="../mmisam_alg/">Multimodal iSAM Algorithm</a></li><li><a class="toctext" href="../multilang/">Multi-Language Support</a></li><li class="current"><a class="toctext" href>Arena Visualization</a><ul class="internal"><li><a class="toctext" href="#Current-Work-In-Progress-1">Current Work In Progress</a></li><li><a class="toctext" href="#Introduction-1">Introduction</a></li><li><a class="toctext" href="#Installation-1">Installation</a></li><li><a class="toctext" href="#Interactive-Gadfly.jl-Plots-1">Interactive Gadfly.jl Plots</a></li><li><a class="toctext" href="#Density-Contour-Map-1">Density Contour Map</a></li><li><a class="toctext" href="#D-Visualization-2">3D Visualization</a></li><li><a class="toctext" href="#Previous-3D-Viewer-(VTK-/-Director)-–-no-longer-required-1">Previous 3D Viewer (VTK / Director) – no longer required</a></li></ul></li><li><a class="toctext" href="../database_interactions/">Cloud Server/Database</a></li><li><a class="toctext" href="../multisession/">Multi/Cross Session Solving</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../../examples/examples/">Caesar Examples</a></li><li><a class="toctext" href="../../examples/basic_continuousscalar/">ContinuousScalar as 1D Example</a></li><li><a class="toctext" href="../../examples/basic_slamedonut/">Under-defined Trilateration SLAM 2D</a></li><li><a class="toctext" href="../../examples/basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="toctext" href="../../examples/interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li></ul></li><li><span class="toctext">Principles</span><ul><li><a class="toctext" href="../../principles/multiplyingDensities/">Multiplying Functions (.py)</a></li></ul></li><li><span class="toctext">How to Expand?</span><ul><li><a class="toctext" href="../adding_variables_factors/">Custom Variables and Factors</a></li><li><a class="toctext" href="../../examples/basic_definingfactors/">Creating Variables and Factors</a></li><li><a class="toctext" href="../../examples/interm_dynpose/">Creating DynPose Factor</a></li></ul></li><li><span class="toctext">Developer Zone</span><ul><li><a class="toctext" href="../../dev/wiki/">Wiki Pointer</a></li></ul></li><li><span class="toctext">Literature</span><ul><li><a class="toctext" href="../../refs/literature/">References</a></li></ul></li><li><span class="toctext">Function Reference</span><ul><li><a class="toctext" href="../../func_ref/">Caesar&#39;s Reference</a></li><li><a class="toctext" href="../../vis_func_ref/">Visualization Reference</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Initial Concepts</li><li><a href>Arena Visualization</a></li></ul><a class="edit-page" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/concepts/arena_visualizations.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Arena Visualization</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Visualization-with-Arena.jl-1" href="#Visualization-with-Arena.jl-1">Visualization with Arena.jl</a></h1><p>Caesar.jl uses the <a href="https://github.com/dehann/Arena.jl">Arena.jl</a> package for all the visualization requirements.  This part of the documentation discusses the robotic visualization aspects supported by Arena.jl. Arena.jl supports a wide variety of general visualization as well as developer visualization tools more focused on research and development.</p><h2><a class="nav-anchor" id="Current-Work-In-Progress-1" href="#Current-Work-In-Progress-1">Current Work In Progress</a></h2><blockquote><p>Written Nov 2018</p></blockquote><p>While Arena.jl is still being upgraded for Julia 1.0 (mostly relating to updates in 3D visualization), the 2D visualizations available through the development master branch in <a href="http://www.github.com/JuliaRobotics/RoMEPlotting.jl">RoMEPlotting.jl</a> are available in Julia 1.0.  The master branch version can be installed using the Julia package manager with <code>add RoMEPlotting#master</code>, see also <a href="../../installation_environment/">environment installation page</a>.</p><h2><a class="nav-anchor" id="Introduction-1" href="#Introduction-1">Introduction</a></h2><p>Over time, Caesar.jl has used a least three different 3D visualization technologies, with the most recent based on WebGL and <a href="https://threejs.org/">three.js</a> by means of the <a href="https://github.com/rdeits/MeshCat.jl">MeshCat.jl</a> package. The previous incarnation used a client side installation of <a href="https://www.vtk.org/">VTK</a>  by means of the <a href="https://github.com/rdeits/DrakeVisualizer.jl">DrakeVisualizer.jl</a> and <a href="https://github.com/RobotLocomotion/director">Director</a> libraries. Different 2D plotting libraries have also been used, with evolutions to improve usability for a wider user base. Each epoch has aimed at reducing dependencies and increasing multi-platform support.</p><p>The sections below discuss 2D and 3D visualization techniques available to the Caesar.jl robot navigation system. Visualization examples will be seen throughout the Caesar.jl package documentation. Arena.jl is intended to simplify the process 2D plotting for robot trajectories in two or three dimensions. The visualizations are also intended to help with subgraph plotting for finding loop closures in data or compare two datasets.</p><blockquote><p><strong>Note</strong> that all visualizations used to be part of the Caesar.jl package itself, but was separated out to Arena.jl in early 2018.</p></blockquote><h2><a class="nav-anchor" id="Installation-1" href="#Installation-1">Installation</a></h2><h3><a class="nav-anchor" id="MeshCat-/-three.js-Viewer-(WebGL)-1" href="#MeshCat-/-three.js-Viewer-(WebGL)-1">MeshCat / three.js Viewer (WebGL)</a></h3><p>For the 3D visualization tools provided for Caesar.jl–-in a <a href="http://www.julialang.org">Julia</a> or (<a href="http://www.juliacomputing.com">JuliaPro</a>) terminal/REPL–-type <code>]</code> to activate pkg manager and install Arena the master branch</p><pre><code class="language-julia">(v1.0) pkg&gt; add Arena#master</code></pre><p>Current master branch development allows the user to use the <a href="https://threejs.org/">three.js</a> WebGL based viewer via <a href="https://github.com/rdeits/MeshCat.jl">MeshCat.jl</a>.</p><h3><a class="nav-anchor" id="D-Visualization-1" href="#D-Visualization-1">2D Visualization</a></h3><p>2D plot visualizations, provided by [RoMEPlotting.jl(http://www.github.com/JuliaRobotics/RoMEPlotting.jl) and <a href="http://www.github.com/JuliaRobotics/KernelDensityEstimatePlotting.jl">KernelDensityEstimatePlotting.jl</a>, are generally useful for repeated analysis of a algorithm or data set being studied. These visualizations are often manipulated to emphasize particular aspects of mobile platform navigation.</p><p>Install RoMEPlotting master branch:</p><pre><code class="language-julia">(v1.0) pkg&gt; add RoMEPlotting#master</code></pre><h2><a class="nav-anchor" id="Interactive-Gadfly.jl-Plots-1" href="#Interactive-Gadfly.jl-Plots-1">Interactive Gadfly.jl Plots</a></h2><p>See the following two discussions on Interactive 2D plots:</p><ul><li><a href="http://gadflyjl.org/stable/tutorial/#Interactivity-1">Interactivity</a></li><li><a href="http://gadflyjl.org/stable/man/backends/#Interactive-SVGs-1">Interactive-SVGs</a></li></ul><h3><a class="nav-anchor" id="Hexagonal-2D-SLAM-example-visualization-1" href="#Hexagonal-2D-SLAM-example-visualization-1">Hexagonal 2D SLAM example visualization</a></h3><p>The major 2D plotting functions between <code>RoMEPlotting.jl</code>:</p><ul><li><code>drawPoses</code></li><li><code>drawPosesLandms</code></li><li><code>drawSubmaps</code></li></ul><p>and <code>KernelDensityEstimatePlotting.jl</code>:</p><ul><li><code>plotKDE</code> / <code>plot(::KernelDensityEstimate)</code></li></ul><p>This simplest example for visualizing a 2D robot trajectory–-such as first running <a href="http://www.juliarobotics.org/Caesar.jl/latest/tut_hexagonal2d.html">the Hexagonal 2D SLAM example</a>–-</p><pre><code class="language-julia"># Assuming some fg::FactorGraph has been loaded/constructed
# ...

using RoMEPlotting

# For Juno/Jupyter style use
pl = drawPosesLandms(fg)

# For scripting use-cases you can export the image
Gadfly.draw(PDF(&quot;/tmp/test.pdf&quot;, 20cm, 10cm),pl)  # or PNG(...)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42294545-c6c80f70-7faf-11e8-8167-017889cee932.png" alt="test"/></p><h2><a class="nav-anchor" id="Density-Contour-Map-1" href="#Density-Contour-Map-1">Density Contour Map</a></h2><p><code>KernelDensityEstimatePlotting</code> (as used in <code>RoMEPlotting</code>) provides an interface to visualize belief densities as counter plots. The following basic example shows some of features of the API, where <code>plotKDE(..., dims=[1;2])</code> implies the marginal over variables <code>(x,y)</code>:</p><pre><code class="language-julia">using RoME, Distributions
using RoMEPlotting

fg = initfg()
addVariable!(fg, :x0, Pose2)
addFactor!(fg, [:x0], PriorPose2(MvNormal(zeros(3), eye(3))))
addVariable!(fg, :x1, Pose2)
addFactor!(fg, [:x0;:x1], Pose2Pose2(MvNormal([10.0;0;0], eye(3))))

ensureAllInitialized!(fg)

# plot one contour density
plX0 = plotKDE(fg, :x0, dims=[1;2])
# using Gadfly; Gadfly.draw(PNG(&quot;/tmp/testX0.png&quot;,20cm,10cm),plX0)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42532654-93f9a87e-8455-11e8-9dc7-b00f73f1321a.png" alt="test"/></p><p>The contour density relates to the distribution of marginal samples as seen with this <a href="http://gadflyjl.org/stable/">Gadfly.jl package</a> histogram comparison.</p><pre><code class="language-julia">pl1 = drawPoses(fg, to=0);
X0 = getVal(fg, :x0);
pl2 = Gadfly.plot(x=X0[1,:],y=X0[2,:], Geom.hexbin);
plH = hstack(pl1, pl2)
# Gadfly.draw(PNG(&quot;/tmp/testH.png&quot;,20cm,10cm),plH)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42533539-2c8571e8-8458-11e8-86f6-39d1e5c94242.png" alt="testh"/></p><p><strong>NOTE</strong> Red and Green lines represent Port and Starboard direction of <code>Pose2</code>, respectively.</p><p>Multiple beliefs can be plotted at the same time, while setting <code>levels=4</code> rather than the default value:</p><pre><code class="language-julia">plX1 = plotKDE(fg, [:x0; :x1], dims=[1;2], levels=4)
# Gadfly.draw(PNG(&quot;/tmp/testX1.png&quot;,20cm,10cm),plX1)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42532963-656cef56-8456-11e8-9636-42592c0d148c.png" alt="testx1"/></p><p>One dimensional (such as <code>Θ</code>) or a stack of all plane projections is also available:</p><pre><code class="language-julia">plTh = plotKDE(fg, [:x0; :x1], dims=[3], levels=4)
# Gadfly.draw(PNG(&quot;/tmp/testTh.png&quot;,20cm,10cm),plTh)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42533188-2dee90c4-8457-11e8-9844-0ef57fba1c82.png" alt="testth"/></p><pre><code class="language-julia">plAll = plotKDE(fg, [:x0; :x1], levels=3)
# Gadfly.draw(PNG(&quot;/tmp/testX1.png&quot;,20cm,15cm),plAll)</code></pre><p><img src="https://user-images.githubusercontent.com/6412556/42533225-42ddaf9c-8457-11e8-8b0d-b1f3695d8b00.png" alt="testall"/></p><p><strong>NOTE</strong> The functions <code>hstack</code> and <code>vstack</code> is provided through the <code>Gadfly</code> package and allows the user to build a near arbitrary composition of plots.</p><p>Please see <a href="https://github.com/JuliaRobotics/KernelDensityEstimatePlotting.jl">KernelDensityEstimatePlotting package source</a> for more features.</p><h2><a class="nav-anchor" id="D-Visualization-2" href="#D-Visualization-2">3D Visualization</a></h2><p>Factor graphs of two or three dimensions can be visualized with the 3D visualizations provided by Arena.jl and it&#39;s dependencies. The 2D example above and also be visualized in a 3D space with the commands:</p><pre><code class="language-julia">vc = startdefaultvisualization() # to load a DrakeVisualizer/Director process instance
visualize(fg, vc, drawlandms=false)
# visualizeallposes!(vc, fg, drawlandms=false)</code></pre><p>Here is a basic example of using visualization and multi-core factor graph solving:</p><pre><code class="language-julia">addprocs(2)
using Caesar, RoME, TransformUtils, Distributions

# load scene and ROV model (might experience UDP packet loss LCM buffer not set)
sc1 = loadmodel(:scene01); sc1(vc)
rovt = loadmodel(:rov); rovt(vc)

initCov = 0.001*eye(6); [initCov[i,i] = 0.00001 for i in 4:6];
odoCov = 0.0001*eye(6); [odoCov[i,i] = 0.00001 for i in 4:6];
rangecov, bearingcov = 3e-4, 2e-3

# start and add to a factor graph
fg = identitypose6fg(initCov=initCov)
tf = SE3([0.0;0.7;0.0], Euler(pi/4,0.0,0.0) )
addOdoFG!(fg, Pose3Pose3(MvNormal(veeEuler(tf), odoCov) ) )

addLinearArrayConstraint(fg, (4.0, 0.0), :x0, :l1, rangecov=rangecov,bearingcov=bearingcov)
addLinearArrayConstraint(fg, (4.0, 0.0), :x1, :l1, rangecov=rangecov,bearingcov=bearingcov)

solveBatch!(fg)

using Arena

vc = startdefaultvisualization()
visualize(fg, vc, drawlandms=true, densitymeshes=[:l1;:x2])
visualizeDensityMesh!(vc, fg, :l1)
# visualizeallposes!(vc, fg, drawlandms=false)</code></pre><h2><a class="nav-anchor" id="Previous-3D-Viewer-(VTK-/-Director)-–-no-longer-required-1" href="#Previous-3D-Viewer-(VTK-/-Director)-–-no-longer-required-1">Previous 3D Viewer (VTK / Director) – no longer required</a></h2><p>Previous versions used the much larger VTK based Director available via <a href="https://github.com/rdeits/DrakeVisualizer.jl">DrakeVisualizer.jl package</a>.  This requires the following preinstalled packages:</p><pre><code class="language-bash">    sudo apt-get install libvtk5-qt4-dev python-vtk</code></pre><footer><hr/><a class="previous" href="../multilang/"><span class="direction">Previous</span><span class="title">Multi-Language Support</span></a><a class="next" href="../database_interactions/"><span class="direction">Next</span><span class="title">Cloud Server/Database</span></a></footer></article></body></html>
