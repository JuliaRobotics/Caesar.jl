<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multi-Modal/Hypothesis · Caesar.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Caesar.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../why_nongaussian/">Gaussian vs. Non-Gaussian</a></li><li><a class="tocitem" href="../../installation_environment/">Installation</a></li><li><a class="tocitem" href="../using_julia/">Using Julia</a></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../concepts/">Initial Concepts</a></li><li><a class="tocitem" href="../building_graphs/">Building Graphs</a></li><li><a class="tocitem" href="../solving_graphs/">Solving Graphs</a></li><li><a class="tocitem" href="../interacting_fgs/">Interact w Graphs</a></li><li class="is-active"><a class="tocitem" href>Multi-Modal/Hypothesis</a><ul class="internal"><li><a class="tocitem" href="#section_multihypo"><span>Multihypothesis</span></a></li><li><a class="tocitem" href="#Mixture-Models"><span>Mixture Models</span></a></li><li><a class="tocitem" href="#Raw-Correlator-Probability-(Matched-Filter)"><span>Raw Correlator Probability (Matched Filter)</span></a></li><li class="toplevel"><a class="tocitem" href="#Null-Hypothesis"><span>Null Hypothesis</span></a></li></ul></li><li><a class="tocitem" href="../parallel_processing/">Parallel Processing</a></li><li><a class="tocitem" href="../../examples/parametric_solve/">[DEV] Parametric Solve</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Caesar Examples</a></li><li><a class="tocitem" href="../../examples/basic_continuousscalar/">Canonical 1D Example</a></li><li><a class="tocitem" href="../../examples/basic_slamedonut/">Underconstrained Range-only</a></li><li><a class="tocitem" href="../../examples/basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="tocitem" href="../../examples/interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li><li><a class="tocitem" href="../../examples/deadreckontether/">Dead Reckon Tether</a></li></ul></li><li><span class="tocitem">Graph Library</span><ul><li><a class="tocitem" href="../../examples/canonical_graphs/">Canonical Generators</a></li><li><a class="tocitem" href="../available_varfacs/">Variables/Factors</a></li><li><a class="tocitem" href="../entry_data/">Entry=&gt;Data Blob</a></li><li><a class="tocitem" href="../../examples/using_images/">Images and AprilTags</a></li><li><a class="tocitem" href="../../examples/using_pcl/">Pointclouds and PCL</a></li><li><a class="tocitem" href="../using_manifolds/">Using Manifolds.jl</a></li><li><a class="tocitem" href="../flux_factors/">Flux (NN) Factors</a></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../install_viz/">Installing Viz</a></li><li><a class="tocitem" href="../2d_plotting/">Plotting (2D)</a></li><li><a class="tocitem" href="../arena_visualizations/">Visualization (3D)</a></li></ul></li><li><span class="tocitem">Middlewares</span><ul><li><a class="tocitem" href="../../examples/using_ros/">ROS Middleware</a></li><li><a class="tocitem" href="../compile_binary/">Compile Binaries</a></li><li><a class="tocitem" href="../zero_install/">Zero Install Solution</a></li><li><a class="tocitem" href="../multisession/">Multi-session/agent Solving</a></li><li><a class="tocitem" href="../multilang/">Multi-Language Support</a></li></ul></li><li><span class="tocitem">How to Expand?</span><ul><li><a class="tocitem" href="../../caesar_framework/">Pkg Framework</a></li><li><a class="tocitem" href="../../examples/custom_variables/">Custom Variables</a></li><li><a class="tocitem" href="../../examples/basic_definingfactors/">Custom Prior Factor</a></li><li><a class="tocitem" href="../../examples/custom_relative_factors/">Custom Relative Factor</a></li><li><a class="tocitem" href="../stash_and_cache/">Caching and Stashing</a></li><li><a class="tocitem" href="../../examples/custom_factor_features/">Important Factor Features</a></li><li><a class="tocitem" href="../../examples/adding_variables_factors/">Variable/Factor Considerations</a></li><li><a class="tocitem" href="../../func_ref/">More Functions</a></li></ul></li><li><span class="tocitem">Principles</span><ul><li><a class="tocitem" href="../../principles/filterCorrespondence/">Filters vs. Graphs</a></li><li><a class="tocitem" href="../../principles/approxConvDensities/">Generic Convolutions</a></li><li><a class="tocitem" href="../../principles/multiplyingDensities/">Multiplying Functions (.py)</a></li><li><a class="tocitem" href="../../principles/bayestreePrinciples/">Bayes (Junction) tree</a></li><li><a class="tocitem" href="../../principles/initializingOnBayesTree/">Advanced Bayes Tree Topics</a></li><li><a class="tocitem" href="../mmisam_alg/">Non-Gaussian Algorithm</a></li></ul></li><li><span class="tocitem">Developer Zone</span><ul><li><a class="tocitem" href="../../dev/wiki/">Wiki Pointers</a></li><li><a class="tocitem" href="../../examples/legacy_deffactors/">Legacy Factors</a></li><li><a class="tocitem" href="../../principles/interm_dynpose/">Creating DynPose Factor</a></li><li><a class="tocitem" href="../../dev/known_issues/">Known Issue List</a></li><li><a class="tocitem" href="../../dev/internal_fncs/">Internal Functions</a></li></ul></li><li><span class="tocitem">Literature</span><ul><li><a class="tocitem" href="../../refs/literature/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Multi-Modal/Hypothesis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multi-Modal/Hypothesis</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/concepts/dataassociation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Association-and-Hypotheses"><a class="docs-heading-anchor" href="#Data-Association-and-Hypotheses">Data Association and Hypotheses</a><a id="Data-Association-and-Hypotheses-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Association-and-Hypotheses" title="Permalink"></a></h1><p>Ambiguous data and processing often produce complicated data association situations.  In SLAM, loop-closures are a major source of concern when developing autonomous subsystems or behaviors. To illustrate this point, consider the two scenarios depicted below:</p><p align="center">
<img src="https://user-images.githubusercontent.com/6412556/76276600-2686ef00-627e-11ea-9c86-fd21852ef793.png" width="640" border="0" />
</p><p>In conventional parametric Gaussian-only systems an incorrect loop-closure can occur, resulting in highly unstable numerical solutions. The mm-iSAM algorithm was conceived to directly address these (and other related) issues by changing the fundamental manner in which the statistical inference is performed.</p><p>The data association problem applies well beyond just loop-closures including (but not limited to) navigation-affordance matching and discrepancy detection, and indicates the versatility of the IncrementalInference.jl standardized <code>multihypo</code> interface.  Note that much more is possible, however, the so-called single-fraction multihypo approach already yields significant benefits and simplicity.</p><h2 id="section_multihypo"><a class="docs-heading-anchor" href="#section_multihypo">Multihypothesis</a><a id="section_multihypo-1"></a><a class="docs-heading-anchor-permalink" href="#section_multihypo" title="Permalink"></a></h2><p>Consider for example a regular three variable factor <code>[:pose;:landmark;:calib]</code> that due to some decision has a triple association uncertainty about the middle variable.  This <em>fractional certainty</em> can easily be modelled via:</p><pre><code class="language-julia hljs">addFactor!(fg, [:p10, :l1_a,:l1_b,:l1_c, :c], PoseLandmCalib, multihypo=[1; 0.6;0.3;0.1; 1])</code></pre><p>Therefore, the user can &quot;partition&quot; certainty about one variable using any arbitrary n-ary factor.  The 100% certain variables are indicated as <code>1</code>, while the remaining uncertainties regarding the uncertain data association decision are grouped as positive fractions that sum to <code>1</code>. In this example, the values <code>0.6,0.3,0.1</code> represent the confidence about the association between <code>:p10</code> and  either of <code>:l1_a,:l1_b,:l1_c</code>.</p><p>A more classical binary multihypothesis example is illustated in the multimodal (non-Gaussian) factor graph below:</p><p align="center">
<img src="https://user-images.githubusercontent.com/6412556/76276833-dfe5c480-627e-11ea-9d84-2df1e1138bbf.png" width="640" border="0" />
</p><h2 id="Mixture-Models"><a class="docs-heading-anchor" href="#Mixture-Models">Mixture Models</a><a id="Mixture-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Mixture-Models" title="Permalink"></a></h2><p><code>Mixture</code> is a different kind of multi-modal modeling where different hypotheses of the measurement itself are unknown.  It is possible to also model uncertain data associations as a <code>Mixture(Prior,...)</code> but this is a feature of factor graph modeling something different than data association uncertainty in n-ary factors: e.g. it is possible to use <code>Mixture</code> together with <code>multihypo=</code> and be sure to take the time to understand the different and how these concepts interact. The Caesar.jl solution is more general than simply allocating different mixtures to different association decisions.  All these elements together can create quite the multi-modal soup.  A practical example from SLAM is a loop-closure where a robot observes an object similar to one previously seen.  The measurement observation is one thing (can maybe be a <code>Mixture</code>) and the association of this &quot;measurement&quot; with this or that variable is a multihypothesis selection.</p><p>See the <a href="https://github.com/JuliaRobotics/IncrementalInference.jl/blob/c9a69ee4cdd3868019ac53b14dba9690d80ec3fa/examples/RobotFourDoor.jl#L18-L20">familiar RobotFourDoor.jl as example as a highly simplified case using priors where these elements effectively all the same thing</a>.  Again, <code>Mixture</code> is something different than <code>multihypo=</code> and the two can be used together.</p><p>A mixture can be created from any existing prior or relative likelihood factor, for example:</p><pre><code class="language-julia hljs">mlr = Mixture(LinearRelative, 
              (correlator=AliasingScalarSampler(...), naive=Normal(0.5,5), lucky=Uniform(0,10)),
              [0.5;0.4;0.1])

addFactor!(fg, [:x0;:x1], mlr)</code></pre><p>See a example with <a href="../../examples/basic_continuousscalar/#Defining-A-Mixture-Relative-on-ContinuousScalar">Defining A Mixture Relative on ContinuousScalar</a> for more details.</p><article class="docstring"><header><a class="docstring-binding" id="IncrementalInference.Mixture" href="#IncrementalInference.Mixture"><code>IncrementalInference.Mixture</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Mixture{N, F&lt;:AbstractFactor, S, T&lt;:Tuple} &lt;: AbstractFactor</code></pre><p>A <code>Mixture</code> object for use with either a <code>&lt;: AbstractPrior</code> or <code>&lt;: AbstractRelative</code>.</p><p>Notes</p><ul><li>The internal data representation is a <code>::NamedTuple</code>, which allows total type-stability for all component types.</li><li>Various construction helpers can accept a variety of inputs, including <code>&lt;: AbstractArray</code> and <code>Tuple</code>.</li><li><code>N</code> is the number of components used to make the mixture, so two bumps from two Normal components means <code>N=2</code>.</li></ul><p>DevNotes</p><ul><li>FIXME swap API order so Mixture of distibutions works like a distribtion, see Caesar.jl #808<ul><li>Should not have field mechanics.</li></ul></li><li>TODO on sampling see #1099 and #1094 and #1069 </li></ul><p>Example</p><pre><code class="language-juila hljs"># prior factor
msp = Mixture(Prior, 
              [Normal(0,0.1), Uniform(-pi/1,pi/2)],
              [0.5;0.5])

addFactor!(fg, [:head], msp, tags=[:MAGNETOMETER;])

# Or relative
mlr = Mixture(LinearRelative, 
              (correlator=AliasingScalarSampler(...), naive=Normal(0.5,5), lucky=Uniform(0,10)),
              [0.5;0.4;0.1])

addFactor!(fg, [:x0;:x1], mlr)</code></pre></div></section></article><h2 id="Raw-Correlator-Probability-(Matched-Filter)"><a class="docs-heading-anchor" href="#Raw-Correlator-Probability-(Matched-Filter)">Raw Correlator Probability (Matched Filter)</a><a id="Raw-Correlator-Probability-(Matched-Filter)-1"></a><a class="docs-heading-anchor-permalink" href="#Raw-Correlator-Probability-(Matched-Filter)" title="Permalink"></a></h2><p>Realistic measurement processes are based on physical process observations such as wave function <a href="https://en.wikipedia.org/wiki/Interferometry">interferometry</a> or <a href="https://en.wikipedia.org/wiki/Matched_filter">matched filtering correlation</a>.  This style of measurement is common in RADAR and SONAR systems, and can be directly incorporated in Caesar.jl since the measurement likelihood models need not be parametric.  There the raw correlator output from a sensor measurement can be directly modelled and included as part of the factor algebriac likelihood probability function:</p><pre><code class="language-julia hljs"># Building a samplable likelihood, using softmax to convert intensity-energy into a pseudo-probability
rangeLikeli = AliasingScalarSampler(rangeIndex, Flux.softmax(correlatorIntensity))

# or alternatively with existing samples similar to a what a particle filter would have done
rangeLikeli = manikde!(Euclid{1}, probPoints)

# add the relative algebra, and remember you can construct your own highly non-linear factor
rangeFct = Pose2Point2Range(rangeLikeli)

addFactor!(fg, [:x8, :beacon_8], rangeFct)</code></pre><h3 id="Various-SamplableBelief-Distribution-Types"><a class="docs-heading-anchor" href="#Various-SamplableBelief-Distribution-Types">Various SamplableBelief Distribution Types</a><a id="Various-SamplableBelief-Distribution-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Various-SamplableBelief-Distribution-Types" title="Permalink"></a></h3><p>Also recognize that other features like <code>multihypo=</code> and <a href="#IncrementalInference.Mixture"><code>Mixture</code></a> readily be combined with object like this <code>rangeFct</code> shown above.  These tricks are all possible due to the multiple dispatch magic of JuliaLang, more explicitly the following is code will all return true:</p><pre><code class="language-julia hljs">IIF.AliasingScalarSampler &lt;: IIF.SamplableBelief
IIF.Mixture &lt;: IIF.SamplableBelief
KDE.BallTreeDensity &lt;: IIF.SamplableBelief
Distribution.Rayleigh &lt;: IIF.SamplableBelief
Distribution.Uniform &lt;: IIF.SamplableBelief
Distribution.MvNormal &lt;: IIF.SamplableBelief</code></pre><p>One of the more exotic examples is to natively represent Synthetic Aperture Sonar (SAS) as a deeply non-Gaussian factor in the factor graph.  See <a href="../../examples/examples/#Synthetic-Aperture-Sonar-SLAM">Synthetic Aperture Sonar SLAM</a>.  Also see the full AUV stack using a single reference beacon and <a href="../../examples/examples/#Towards-Real-Time-Underwater-Acoustic-Navigation">Towards Real-Time Underwater Acoustic Navigation</a>.</p><h1 id="Null-Hypothesis"><a class="docs-heading-anchor" href="#Null-Hypothesis">Null Hypothesis</a><a id="Null-Hypothesis-1"></a><a class="docs-heading-anchor-permalink" href="#Null-Hypothesis" title="Permalink"></a></h1><p>Sometimes there is basic uncertainty about whether a measurement is at all valid.  Note that the above examples (<code>multihypo</code> and <code>Mixture</code>) still accept that a certain association definitely exists. A null hypothesis models the situation in which a factor might be completely bogus, in which case it should be ignored.  The underlying mechanics of this approach are not entirely straightforward since removing one or more factors essentially changes the structure of the graph.  That said, IncrementalInference.jl employs a reasonable stand-in solution that does not require changing the graph structure and can simply be included for any factor.</p><pre><code class="language-julia hljs">addFactor!(fg, [:x7;:l13], Pose2Point2Range(...), nullhypo=0.1)</code></pre><p>This keyword indicates to the solver that there is a 10% chance that this factor is not valid.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><a href="../flux_factors/">An entirely separate page is reserved for incorporating Flux neural network models into Caesar.jl</a> as highly plastic and trainable (i.e. learnable) factors.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../interacting_fgs/">« Interact w Graphs</a><a class="docs-footer-nextpage" href="../parallel_processing/">Parallel Processing »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 28 September 2022 04:41">Wednesday 28 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
