<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solving Graphs · Caesar.jl</title><meta name="title" content="Solving Graphs · Caesar.jl"/><meta property="og:title" content="Solving Graphs · Caesar.jl"/><meta property="twitter:title" content="Solving Graphs · Caesar.jl"/><meta name="description" content="Documentation for Caesar.jl."/><meta property="og:description" content="Documentation for Caesar.jl."/><meta property="twitter:description" content="Documentation for Caesar.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Caesar.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../why_nongaussian/">Gaussian vs. Non-Gaussian</a></li><li><a class="tocitem" href="../../installation_environment/">Installation</a></li><li><a class="tocitem" href="../using_julia/">Using Julia</a></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../concepts/">Initial Concepts</a></li><li><a class="tocitem" href="../building_graphs/">Building Graphs</a></li><li class="is-active"><a class="tocitem" href>Solving Graphs</a><ul class="internal"><li><a class="tocitem" href="#Non-parametric-Batch-Solve"><span>Non-parametric Batch Solve</span></a></li><li><a class="tocitem" href="#variable_init"><span>Automatic vs Manual Init</span></a></li><li><a class="tocitem" href="#Using-Incremental-Updates-(Clique-Recycling-I)"><span>Using Incremental Updates (Clique Recycling I)</span></a></li><li><a class="tocitem" href="#Using-Clique-out-marginalization-(Clique-Recycling-II)"><span>Using Clique out-marginalization (Clique Recycling II)</span></a></li><li><a class="tocitem" href="#sync_over_graph_solvable"><span>Synchronizing Over a Factor Graph</span></a></li></ul></li><li><a class="tocitem" href="../interacting_fgs/">Interact w Graphs</a></li><li><a class="tocitem" href="../dataassociation/">Multi-Modal/Hypothesis</a></li><li><a class="tocitem" href="../parallel_processing/">Parallel Processing</a></li><li><a class="tocitem" href="../../examples/parametric_solve/">[DEV] Parametric Solve</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Caesar Examples</a></li><li><a class="tocitem" href="../../examples/basic_continuousscalar/">Canonical 1D Example</a></li><li><a class="tocitem" href="../../examples/basic_slamedonut/">Underconstrained Range-only</a></li><li><a class="tocitem" href="../../examples/basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="tocitem" href="../../examples/interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li><li><a class="tocitem" href="../../examples/deadreckontether/">Dead Reckon Tether</a></li></ul></li><li><span class="tocitem">Graph Library</span><ul><li><a class="tocitem" href="../../examples/canonical_graphs/">Canonical Generators</a></li><li><a class="tocitem" href="../available_varfacs/">Variables/Factors</a></li><li><a class="tocitem" href="../entry_data/">Entry=&gt;Data Blob</a></li><li><a class="tocitem" href="../../examples/using_images/">Images and AprilTags</a></li><li><a class="tocitem" href="../../examples/using_pcl/">Pointclouds and PCL</a></li><li><a class="tocitem" href="../using_manifolds/">Using Manifolds.jl</a></li><li><a class="tocitem" href="../flux_factors/">Flux (NN) Factors</a></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../install_viz/">Installing Viz</a></li><li><a class="tocitem" href="../2d_plotting/">Plotting (2D)</a></li><li><a class="tocitem" href="../arena_visualizations/">Visualization (3D)</a></li></ul></li><li><span class="tocitem">Middlewares</span><ul><li><a class="tocitem" href="../../examples/using_ros/">ROS Middleware</a></li><li><a class="tocitem" href="../compile_binary/">Compile Binaries</a></li><li><a class="tocitem" href="../zero_install/">Zero Install Solution</a></li><li><a class="tocitem" href="../multisession/">Multi-session/agent Solving</a></li><li><a class="tocitem" href="../multilang/">Multi-Language Support</a></li></ul></li><li><span class="tocitem">How to Expand?</span><ul><li><a class="tocitem" href="../../caesar_framework/">Pkg Framework</a></li><li><a class="tocitem" href="../../examples/custom_variables/">Custom Variables</a></li><li><a class="tocitem" href="../../examples/basic_definingfactors/">Custom Prior Factor</a></li><li><a class="tocitem" href="../../examples/custom_relative_factors/">Custom Relative Factor</a></li><li><a class="tocitem" href="../stash_and_cache/">Caching and Stashing</a></li><li><a class="tocitem" href="../../examples/custom_factor_features/">Important Factor Features</a></li><li><a class="tocitem" href="../../examples/adding_variables_factors/">Variable/Factor Considerations</a></li><li><a class="tocitem" href="../../func_ref/">More Functions</a></li></ul></li><li><span class="tocitem">Principles</span><ul><li><a class="tocitem" href="../../principles/filterCorrespondence/">Filters vs. Graphs</a></li><li><a class="tocitem" href="../../principles/approxConvDensities/">Generic Convolutions</a></li><li><a class="tocitem" href="../../principles/multiplyingDensities/">Multiplying Functions (.py)</a></li><li><a class="tocitem" href="../../principles/bayestreePrinciples/">Bayes (Junction) tree</a></li><li><a class="tocitem" href="../../principles/initializingOnBayesTree/">Advanced Bayes Tree Topics</a></li><li><a class="tocitem" href="../mmisam_alg/">Non-Gaussian Algorithm</a></li></ul></li><li><span class="tocitem">Developer Zone</span><ul><li><a class="tocitem" href="../../dev/wiki/">Wiki Pointers</a></li><li><a class="tocitem" href="../../examples/legacy_deffactors/">Legacy Factors</a></li><li><a class="tocitem" href="../../principles/interm_dynpose/">Creating DynPose Factor</a></li><li><a class="tocitem" href="../../dev/known_issues/">Known Issue List</a></li><li><a class="tocitem" href="../../dev/internal_fncs/">Internal Functions</a></li></ul></li><li><span class="tocitem">Literature</span><ul><li><a class="tocitem" href="../../refs/literature/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Solving Graphs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solving Graphs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaRobotics/Caesar.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/concepts/solving_graphs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="solving_graphs"><a class="docs-heading-anchor" href="#solving_graphs">Solving Graphs</a><a id="solving_graphs-1"></a><a class="docs-heading-anchor-permalink" href="#solving_graphs" title="Permalink"></a></h1><h2 id="Non-parametric-Batch-Solve"><a class="docs-heading-anchor" href="#Non-parametric-Batch-Solve">Non-parametric Batch Solve</a><a id="Non-parametric-Batch-Solve-1"></a><a class="docs-heading-anchor-permalink" href="#Non-parametric-Batch-Solve" title="Permalink"></a></h2><p>When you have built the graph, you can call the solver to perform inference with the following:</p><pre><code class="language-julia hljs"># Perform inference
tree = solveTree!(fg) # or solveGraph!</code></pre><p>The returned Bayes (Junction) <code>tree</code> object is described in more detail on <a href="https://juliarobotics.org/Caesar.jl/latest/principles/bayestreePrinciples/">a dedicated documentation page</a>, while <code>smt</code> and <code>hist</code> return values most closely relate to development and debug outputs which can be ignored during general use.  Should an error occur during, the exception information is easily accessible in the <code>smt</code> object (as well as file logs which default to <code>/tmp/caesar/</code>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncrementalInference.solveTree!" href="#IncrementalInference.solveTree!"><code>IncrementalInference.solveTree!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">solveTree!(dfgl; ...)
solveTree!(
    dfgl,
    oldtree;
    timeout,
    storeOld,
    verbose,
    verbosefid,
    delaycliqs,
    recordcliqs,
    limititercliqs,
    injectDelayBefore,
    skipcliqids,
    eliminationOrder,
    eliminationConstraints,
    smtasks,
    dotreedraw,
    runtaskmonitor,
    algorithm,
    solveKey,
    multithread
)
</code></pre><p>Perform inference over the Bayes tree according to <code>opt::SolverParams</code> and keyword arguments.</p><p>Notes</p><ul><li>Aliased with <code>solveGraph!</code></li><li>Variety of options, including fixed-lag solving – see <code>getSolverParams(fg)</code> for details.<ul><li>See online Documentation for more details: https://juliarobotics.org/Caesar.jl/latest/</li></ul></li><li>Latest result always stored in <code>solvekey=:default</code>.</li><li>Experimental <code>storeOld::Bool=true</code> will duplicate the current result as supersolve <code>:default_k</code>.<ul><li>Based on <code>solvable==1</code> assumption.</li></ul></li><li><code>limititercliqs</code> allows user to limit the number of iterations a specific CSM does.</li><li>keywords <code>verbose</code> and <code>verbosefid::IOStream</code> can be used together to to send output to file or default <code>stdout</code>.</li><li>keyword <code>recordcliqs=[:x0; :x7...]</code> identifies by frontals which cliques to record CSM steps.<ul><li>See <a href="@ref"><code>repeatCSMStep!</code></a>, <a href="@ref"><code>printCSMHistoryLogical</code></a>, <a href="@ref"><code>printCSMHistorySequential</code></a></li></ul></li></ul><p>DevNotes</p><ul><li>TODO Change keyword arguments to new @parameter <code>SolverOptions</code> type.</li></ul><p>Example</p><pre><code class="language-julia hljs"># pass in old `tree` to enable compute recycling -- see online Documentation for more details
tree = solveTree!(fg [,tree])</code></pre><p>Related</p><p><code>solveGraph!</code>, <a href="@ref"><code>solveCliqUp!</code></a>, <a href="@ref"><code>solveCliqDown!</code></a>, <a href="../../principles/bayestreePrinciples/#IncrementalInference.buildTreeReset!"><code>buildTreeReset!</code></a>, <a href="@ref"><code>repeatCSMStep</code></a>, <a href="@ref"><code>printCSMHistoryLogical</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaRobotics/IncrementalInference.jl/blob/v0.35.4/src/services/SolverAPI.jl#L296-L325">source</a></section></article><h2 id="variable_init"><a class="docs-heading-anchor" href="#variable_init">Automatic vs Manual Init</a><a id="variable_init-1"></a><a class="docs-heading-anchor-permalink" href="#variable_init" title="Permalink"></a></h2><p>Currently the main automatic initialization technique used by IncrementalInference.jl by delayed propagation of belief on the factor graph.  This can be globally or locally controlled via:</p><pre><code class="language-julia hljs">getSolverParams(fg).graphinit = false

# or locally at each addFactor
addFactor!(fg, [:x0;:x1], LinearRelative(Normal()); graphinit=false)</code></pre><p>Use <a href="#IncrementalInference.initVariable!"><code>initVariable!</code></a> if you&#39;d like to force a particular numerical initialization of some or all the variables.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncrementalInference.initVariable!" href="#IncrementalInference.initVariable!"><code>IncrementalInference.initVariable!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initVariable!(
    variable::DFGVariable,
    ptsArr::ManifoldKernelDensity;
    ...
)
initVariable!(
    variable::DFGVariable,
    ptsArr::ManifoldKernelDensity,
    solveKey::Symbol;
    dontmargin,
    N
)
</code></pre><p>Method to manually initialize a variable using a set of points.</p><p>Notes</p><ul><li>Disable automated graphinit on `addFactor!(fg, ...; graphinit=false)<ul><li>any un-initialized variables will automatically be initialized by <code>solveTree!</code></li></ul></li></ul><p>Example:</p><pre><code class="language-julia hljs"># some variable is added to fg
addVariable!(fg, :somepoint3, ContinuousEuclid{2})

# data is organized as (row,col) == (dimension, samples)
pts = randn(2,100)
initVariable!(fg, :somepoint3, pts)

# manifold management should be done automatically.
# note upgrades are coming to consolidate with Manifolds.jl, see RoME #244

## it is also possible to initVariable! by using existing factors, e.g.
initVariable!(fg, :x3, [:x2x3f1])</code></pre><p>DevNotes</p><ul><li>TODO better document graphinit and treeinit.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaRobotics/IncrementalInference.jl/blob/v0.35.4/src/services/GraphInit.jl#L262-L290">source</a></section></article><p>All the variables can be initialized without solving with:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IncrementalInference.initAll!" href="#IncrementalInference.initAll!"><code>IncrementalInference.initAll!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initAll!(dfg; ...)
initAll!(dfg, solveKey; _parametricInit, solvable, N)
</code></pre><p>Perform <code>graphinit</code> over all variables with <code>solvable=1</code> (default).</p><p>See also: <a href="@ref"><code>ensureSolvable!</code></a>, (EXPERIMENTAL &#39;treeinit&#39;)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaRobotics/IncrementalInference.jl/blob/v0.35.4/src/services/GraphInit.jl#L487-L494">source</a></section></article><h2 id="Using-Incremental-Updates-(Clique-Recycling-I)"><a class="docs-heading-anchor" href="#Using-Incremental-Updates-(Clique-Recycling-I)">Using Incremental Updates (Clique Recycling I)</a><a id="Using-Incremental-Updates-(Clique-Recycling-I)-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Incremental-Updates-(Clique-Recycling-I)" title="Permalink"></a></h2><p>One of the major features of the MM-iSAMv2 algorithm (implemented by <a href="http://www.github.com/JuliaRobotics/IncrementalInference.jl">IncrementalInference.jl</a>) is reducing computational load by recycling and marginalizing different (usually older) parts of the factor graph.  In order to utilize the benefits of recycing, the previous Bayes (Junction) tree should also be provided as input (see fixed-lag examples for more details):</p><pre><code class="language-julia hljs">tree = solveTree!(fg, tree)</code></pre><h2 id="Using-Clique-out-marginalization-(Clique-Recycling-II)"><a class="docs-heading-anchor" href="#Using-Clique-out-marginalization-(Clique-Recycling-II)">Using Clique out-marginalization (Clique Recycling II)</a><a id="Using-Clique-out-marginalization-(Clique-Recycling-II)-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Clique-out-marginalization-(Clique-Recycling-II)" title="Permalink"></a></h2><p>When building sysmtes with limited computation resources, the out-marginalization of cliques on the Bayes tree can be used.  This approach limits the amount of variables that are inferred on each solution of the graph.  This method is also a compliment to the above Incremental Recycling – these two methods can work in tandem.  There is a default setting for a FIFO out-marginalization strategy (with some additional tricks):</p><pre><code class="language-julia hljs">defaultFixedLagOnTree!(fg, 50, limitfixeddown=true)</code></pre><p>This call will keep the latest 50 variables fluid for inference during Bayes tree inference.  The keyword <code>limitfixeddown=true</code> in this case will also prevent downward message passing on the Bayes tree from propagating into the out-marginalized branches on the tree.  A later page in this documentation will discuss how the inference algorithm and Bayes tree aspects are put together.</p><h2 id="sync_over_graph_solvable"><a class="docs-heading-anchor" href="#sync_over_graph_solvable">Synchronizing Over a Factor Graph</a><a id="sync_over_graph_solvable-1"></a><a class="docs-heading-anchor-permalink" href="#sync_over_graph_solvable" title="Permalink"></a></h2><p>When adding Variables and Factors, use <code>solvable=0</code> to disable the new fragments until ready for inference, for example</p><pre><code class="language-julia hljs">addVariable!(fg, :x45, Pose2, solvable=0)
newfct = addFactor!(fg, [:x11,:x12], Pose2Pose2, solvable=0)</code></pre><p>These parts of the factor graph can simply be activated for solving:</p><pre><code class="language-julia hljs">setSolvable!(fg, :x45, 1)
setSolvable!(fg, newfct.label, 1)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../building_graphs/">« Building Graphs</a><a class="docs-footer-nextpage" href="../interacting_fgs/">Interact w Graphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 26 August 2024 23:45">Monday 26 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
