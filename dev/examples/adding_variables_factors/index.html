<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Variable/Factor Considerations · Caesar.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Caesar.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../../concepts/why_nongaussian/">Gaussian vs. Non-Gaussian</a></li><li><a class="tocitem" href="../../installation_environment/">Installation</a></li><li><a class="tocitem" href="../../concepts/using_julia/">Using Julia</a></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../concepts/concepts/">Initial Concepts</a></li><li><a class="tocitem" href="../../concepts/building_graphs/">Building Graphs</a></li><li><a class="tocitem" href="../../concepts/solving_graphs/">Solving Graphs</a></li><li><a class="tocitem" href="../../concepts/interacting_fgs/">Interact w Graphs</a></li><li><a class="tocitem" href="../../concepts/dataassociation/">Multi-Modal/Hypothesis</a></li><li><a class="tocitem" href="../../concepts/parallel_processing/">Parallel Processing</a></li><li><a class="tocitem" href="../parametric_solve/">[DEV] Parametric Solve</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/">Caesar Examples</a></li><li><a class="tocitem" href="../basic_continuousscalar/">Canonical 1D Example</a></li><li><a class="tocitem" href="../basic_slamedonut/">Underconstrained Range-only</a></li><li><a class="tocitem" href="../basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="tocitem" href="../interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li><li><a class="tocitem" href="../deadreckontether/">Dead Reckon Tether</a></li></ul></li><li><span class="tocitem">Graph Library</span><ul><li><a class="tocitem" href="../canonical_graphs/">Canonical Generators</a></li><li><a class="tocitem" href="../../concepts/entry_data/">Entry=&gt;Data Blob</a></li><li><a class="tocitem" href="../../concepts/available_varfacs/">Variables/Factors</a></li><li><a class="tocitem" href="../../concepts/flux_factors/">Flux (NN) Factors</a></li><li><a class="tocitem" href="../using_images/">Images and AprilTags</a></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../install_viz/">Installing Viz</a></li><li><a class="tocitem" href="../../concepts/2d_plotting/">Plotting (2D)</a></li><li><a class="tocitem" href="../../concepts/arena_visualizations/">Visualization (3D)</a></li></ul></li><li><span class="tocitem">Middlewares</span><ul><li><a class="tocitem" href="../using_ros/">ROS Middleware</a></li><li><a class="tocitem" href="../../concepts/compile_binary/">Compile Binaries</a></li><li><a class="tocitem" href="../../concepts/zero_install/">Zero Install Solution</a></li><li><a class="tocitem" href="../../concepts/multisession/">Multi-session/agent Solving</a></li><li><a class="tocitem" href="../../concepts/multilang/">Multi-Language Support</a></li></ul></li><li><span class="tocitem">How to Expand?</span><ul><li><a class="tocitem" href="../../caesar_framework/">Pkg Framework</a></li><li><a class="tocitem" href="../custom_variables/">Custom Variables</a></li><li><a class="tocitem" href="../basic_definingfactors/">Custom Prior Factor</a></li><li><a class="tocitem" href="../custom_relative_factors/">Custom Relative Factor</a></li><li><a class="tocitem" href="../custom_factor_features/">Important Factor Features</a></li><li class="is-active"><a class="tocitem" href>Variable/Factor Considerations</a></li><li><a class="tocitem" href="../../func_ref/">More Functions</a></li></ul></li><li><span class="tocitem">Principles</span><ul><li><a class="tocitem" href="../../principles/filterCorrespondence/">Filters vs. Graphs</a></li><li><a class="tocitem" href="../../principles/approxConvDensities/">Generic Convolutions</a></li><li><a class="tocitem" href="../../principles/multiplyingDensities/">Multiplying Functions (.py)</a></li><li><a class="tocitem" href="../../principles/bayestreePrinciples/">Bayes (Junction) tree</a></li><li><a class="tocitem" href="../../principles/initializingOnBayesTree/">Advanced Bayes Tree Topics</a></li><li><a class="tocitem" href="../../concepts/mmisam_alg/">Non-Gaussian Algorithm</a></li></ul></li><li><span class="tocitem">Developer Zone</span><ul><li><a class="tocitem" href="../../dev/wiki/">Wiki Pointers</a></li><li><a class="tocitem" href="../legacy_deffactors/">Legacy Factors</a></li><li><a class="tocitem" href="../../principles/interm_dynpose/">Creating DynPose Factor</a></li><li><a class="tocitem" href="../../dev/known_issues/">Known Issue List</a></li><li><a class="tocitem" href="../../dev/internal_fncs/">Internal Functions</a></li></ul></li><li><span class="tocitem">Literature</span><ul><li><a class="tocitem" href="../../refs/literature/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">How to Expand?</a></li><li class="is-active"><a href>Variable/Factor Considerations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Variable/Factor Considerations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/examples/adding_variables_factors.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Variable/Factor-Considerations"><a class="docs-heading-anchor" href="#Variable/Factor-Considerations">Variable/Factor Considerations</a><a id="Variable/Factor-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Variable/Factor-Considerations" title="Permalink"></a></h1><p>A couple of important points:</p><ul><li>You <strong>do not need to</strong> modify or insert your new code into Caesar/RoME/IncrementalInference source code libraries – they can be created and run anywhere on-the-fly!</li><li>As long as the factors exist in the working space when the solver is run, the factors are automatically used – this is possible due to Julia&#39;s <a href="https://docs.julialang.org/en/v1/manual/methods/index.html">multiple dispatch design</a></li><li>Caesar.jl is designed to allow you to add new variables and factors to your own independent repository and incorporate them at will at compile-time or even run-time</li><li>Residual function definitions for new factors types use a <a href="examples/@ref custom_residual_factor">callable struct (a.k.a functor) architecture</a> to simultaneously allow:  <ul><li>Multiple dispatch (i.e. &#39;polymorphic&#39; behavior)</li><li>Meta-data and in-place memory storage for advanced and performant code</li><li>An outside callback implementation style</li></ul></li><li>In most robotics scenarios, there is no need for new variables or factors:<ul><li>Variables have various mechanisms that allow you to attach data to them, e.g. raw sensory data or identified April tags, so you do not need to create a new variable type just to store data</li><li>New variables are required only if you are representing a new state - TODO: Example of needed state</li><li>New factors are needed if:<ul><li>You need to represent a constraint for a variable (known as a singleton) and that constraint type doesn&#39;t exist</li><li>You need to represent a constraint between two variables and that constraint type doesn&#39;t exist</li></ul></li></ul></li></ul><p>All factors inherit from one of the following types, depending on their function:</p><ul><li>AbstractPrior: AbstractPrior are priors (unary factors) that provide an absolute constraint for a single variable. A simple example of this is an absolute GPS prior, or equivalently a (0, 0, 0) starting location in a <a href="../../concepts/available_varfacs/#RoME.Pose2"><code>Pose2</code></a> scenario.<ul><li>Requires: A getSample function</li></ul></li><li>IIF.AbstractRelativeMinimize: IIF.AbstractRelativeMinimize are relative factors that introduce an algebraic relationship between two or more variables. A simple example of this is an odometry factor between two pose variables, or a range factor indicating the range between a pose and another variable.<ul><li>Requires: A getSample function and a residual function definition</li><li>The minimize suffix specifies that the residual function of this factor will be enforced by numerical minimization (find me the minimum of this function)</li></ul></li><li>IIF.AbstractRelativeRoots: IIF.AbstractRelativeRoots are relative factors that introduce algebraic relationships between two or more variables. They are the same as IIF.AbstractRelativeMinimize, however they use root finding to find the zero crossings (rather than numerical minimization).<ul><li>Requires: A getSample function and a residual function definition</li></ul></li></ul><p>How do you decide which to use?</p><ul><li>If you are creating factors for world-frame information that will be tied to a single variable, inherit from <code>&lt;:AbstractPrior</code><ul><li>GPS coordinates should be priors</li></ul></li><li>If you are creating factors for local-frame relationships between variables, inherit from IIF.AbstractRelativeMinimize<ul><li>Odometry and bearing deltas should be introduced as pairwise factors and should be local frame</li></ul></li></ul><p>TBD: Users should start with IIF.AbstractRelativeMinimize, discuss why and when they should promote their factors to IIF.AbstractRelativeRoots.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>IIF.AbstractRelativeMinimize</code> does not imply that the overall inference algorithm only minimizes an objective function. The MM-iSAM algorithm is built around fixed-point analysis. Minimization is used here to locally enforce the residual function.</p></div></div><p>What you need to build in the new factor:</p><ul><li>A struct for the factor itself</li><li>A sampler function to return measurements from the random ditributions</li><li>If you are building a <a href="examples/@ref"><code>IIF.AbstractRelativeMinimize</code></a> or a <a href="examples/@ref"><code>IIF.AbstractRelativeRoots</code></a> you need to define a residual function to introduce the relative algebraic relationship between the variables<ul><li>Minimization function should be lower-bounded and smooth</li></ul></li><li>A packed type of the factor which must be named Packed[Factor name], and allows the factor to be packed/transmitted/unpacked</li><li>Serialization and deserialization methods<ul><li>These are convert functions that pack and unpack the factor (which may be highly complex) into serialization-compatible formats</li><li>As the factors are mostly comprised of distributions (of type <a href="examples/@ref"><code>SamplableBelief</code></a>), functions are provided to pack and unpack the distributions:<ul><li>Packing: To convert from a <a href="examples/@ref"><code>SamplableBelief</code></a> to a serializable obhect, use <code>convert(PackedSamplableBelief, ::SamplableBelief)</code></li><li>Unpacking: To convert from string back to a <code>SamplableBelief</code>, use <code>convert(SamplableBelief, ::PackedSamplableBelief)</code>  </li></ul></li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../custom_factor_features/">« Important Factor Features</a><a class="docs-footer-nextpage" href="../../func_ref/">More Functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 25 March 2022 18:07">Friday 25 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
