<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Bayes Tree Topics · Caesar.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Caesar.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">Welcome</span><ul><li><a class="tocitem" href="../../installation_environment/">Installation</a></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../concepts/concepts/">Initial Concepts</a></li><li><a class="tocitem" href="../../concepts/building_graphs/">Building Factor Graphs</a></li><li><a class="tocitem" href="../../concepts/interacting_fgs/">Solving and Interacting</a></li><li><a class="tocitem" href="../../concepts/available_varfacs/">Internal Variables/Factors</a></li><li><a class="tocitem" href="../../concepts/dataassociation/">Multi-Modal/Hypothesis</a></li><li><a class="tocitem" href="../../concepts/flux_factors/">Flux (NN) Factors</a></li><li><a class="tocitem" href="../../concepts/2d_plotting/">Plotting (2D)</a></li><li><a class="tocitem" href="../../concepts/entry_data/">Entry=&gt;Data Blob</a></li><li><a class="tocitem" href="../../concepts/multilang/">Multi-Language Support</a></li><li><a class="tocitem" href="../../concepts/database_interactions/">Cloud Server/Database</a></li><li><a class="tocitem" href="../../concepts/multisession/">Multi-session/agent Solving</a></li><li><a class="tocitem" href="../../concepts/arena_visualizations/">Visualization (3D)</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Caesar Examples</a></li><li><a class="tocitem" href="../../examples/basic_continuousscalar/">ContinuousScalar as 1D Example</a></li><li><a class="tocitem" href="../../examples/basic_slamedonut/">Under-defined Trilateration, 2D</a></li><li><a class="tocitem" href="../../examples/basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="tocitem" href="../../examples/interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li><li><a class="tocitem" href="../../examples/using_ros/">ROS Middleware</a></li><li><a class="tocitem" href="../../examples/deadreckontether/">Dead Reckon Tether</a></li></ul></li><li><span class="tocitem">Principles</span><ul><li><a class="tocitem" href="../filterCorrespondence/">Filters vs. Graphs</a></li><li><a class="tocitem" href="../approxConvDensities/">Generic Convolutions</a></li><li><a class="tocitem" href="../multiplyingDensities/">Multiplying Functions (.py)</a></li><li><a class="tocitem" href="../bayestreePrinciples/">Bayes (Junction) tree</a></li><li class="is-active"><a class="tocitem" href>Advanced Bayes Tree Topics</a><ul class="internal"><li><a class="tocitem" href="#Definitions"><span>Definitions</span></a></li><li><a class="tocitem" href="#Are-cliques-in-the-Bayes-(Junction)-tree-densly-connected?"><span>Are cliques in the Bayes (Junction) tree densly connected?</span></a></li><li><a class="tocitem" href="#LU/QR-vs.-Belief-Propagation"><span>LU/QR vs. Belief Propagation</span></a></li><li><a class="tocitem" href="#Bayes-Tree-vs-Bayes-Net"><span>Bayes Tree vs Bayes Net</span></a></li><li><a class="tocitem" href="#Initialization-on-the-Tree"><span>Initialization on the Tree</span></a></li></ul></li><li><a class="tocitem" href="../../concepts/mmisam_alg/">Multimodal iSAM Algorithm</a></li></ul></li><li><span class="tocitem">How to Expand?</span><ul><li><a class="tocitem" href="../../examples/adding_variables_factors/">Custom Variables and Factors</a></li><li><a class="tocitem" href="../../examples/custom_variables/">Creating Variables</a></li><li><a class="tocitem" href="../../examples/basic_definingfactors/">Creating Factors</a></li></ul></li><li><span class="tocitem">Developer Zone</span><ul><li><a class="tocitem" href="../../dev/wiki/">Wiki Pointers</a></li><li><a class="tocitem" href="../interm_dynpose/">Creating DynPose Factor</a></li><li><a class="tocitem" href="../../dev/known_issues/">Known Issue List</a></li><li><a class="tocitem" href="../../dev/internal_fncs/">Internal Functions</a></li></ul></li><li><span class="tocitem">Literature</span><ul><li><a class="tocitem" href="../../refs/literature/">References</a></li></ul></li><li><span class="tocitem">Function Reference</span><ul><li><a class="tocitem" href="../../func_ref/">Caesar&#39;s Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Principles</a></li><li class="is-active"><a href>Advanced Bayes Tree Topics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Bayes Tree Topics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/principles/initializingOnBayesTree.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Topics-on-Bayes-Tree"><a class="docs-heading-anchor" href="#Advanced-Topics-on-Bayes-Tree">Advanced Topics on Bayes Tree</a><a id="Advanced-Topics-on-Bayes-Tree-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Topics-on-Bayes-Tree" title="Permalink"></a></h1><h2 id="Definitions"><a class="docs-heading-anchor" href="#Definitions">Definitions</a><a id="Definitions-1"></a><a class="docs-heading-anchor-permalink" href="#Definitions" title="Permalink"></a></h2><p>Squashing or collapsing the Bayes tree back into a &#39;flat&#39; Bayes net, by chain rule: </p><p class="math-container">\[p(x,y) = p(x|y)p(y) = p(y|x)p(x) \\
p(x,y,z) = p(x|y,z)p(y,z) = p(x,y|z)p(z) = p(x|y,z)p(y|z)p(z) \\
p(x,y,z) = p(x|y,z)p(y)p(z) \, \text{iff y is independent of z,} \, also p(y|z)=p(y)\]</p><h2 id="Are-cliques-in-the-Bayes-(Junction)-tree-densly-connected?"><a class="docs-heading-anchor" href="#Are-cliques-in-the-Bayes-(Junction)-tree-densly-connected?">Are cliques in the Bayes (Junction) tree densly connected?</a><a id="Are-cliques-in-the-Bayes-(Junction)-tree-densly-connected?-1"></a><a class="docs-heading-anchor-permalink" href="#Are-cliques-in-the-Bayes-(Junction)-tree-densly-connected?" title="Permalink"></a></h2><p>Yes and no. From the chordal Bayes net&#39;s perspective (obtained through the elimination game in order to build the clique tree), the nodes of the Bayes tree are indeed fully connected subgraphs (they are called cliques after all!). From the perspective of the subgraph of the original factor graph induced by the clique&#39;s variables, cliques need not be fully connected, since we are assuming the factor graph as sparse, and that no new information can be created out of nothing–-hence each clique must be sparse.  That said, the potential exists for the inference within a clique to become densly connected (experience full &quot;fill-in&quot;).  See the paper on square-root-SAM, where the connection between dense covariance matrix of a Kalman filter (EKF-SLAM) is actually related to the inverse square root (rectangular) matrix which structure equivalent to the clique subgraph adjacency matrix.  </p><p>Also remember that the intermediate Bayes net (which has densly connected cliques) hides the underlying tree structure – think of the Bayes net as looking at the tree from on top or below, thereby encoding the dense connectivity in the structure of the tree itself.  All information below any clique of the tree is encoded in the upward marginal belief messages at that point (i.e. the densly connected aspects pertained lower down in the tree).</p><h2 id="LU/QR-vs.-Belief-Propagation"><a class="docs-heading-anchor" href="#LU/QR-vs.-Belief-Propagation">LU/QR vs. Belief Propagation</a><a id="LU/QR-vs.-Belief-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#LU/QR-vs.-Belief-Propagation" title="Permalink"></a></h2><p>LU/QR is a special case (Parametric/Linear) of more general belief propagation.  The story though is more intricate, where QR/LU assume that product-factors can be formed through the chain rule – using congruency – it is not that straight forward with general beliefs.  In the general case we are almost forced to use belief propagation, which in turn implies special care is needed to describe the relationship between sparse factor graph fragments in cliques on the tree, and the more densely connected structure of the Bayes Net.</p><h2 id="Bayes-Tree-vs-Bayes-Net"><a class="docs-heading-anchor" href="#Bayes-Tree-vs-Bayes-Net">Bayes Tree vs Bayes Net</a><a id="Bayes-Tree-vs-Bayes-Net-1"></a><a class="docs-heading-anchor-permalink" href="#Bayes-Tree-vs-Bayes-Net" title="Permalink"></a></h2><p>The Bayes tree is a purely symbolic structure – i.e. special grouping of factors that all come from the factor graph joint product (product of independently sampled likelihood/conditional models):</p><p class="math-container">\[[\Theta | Z] \propto \prod_i \, [ Z_i=z_i | \Theta_i ]\]</p><p>A sparse factor graph problem can be squashed into smaller dense problem of product-factor conditionals (from variable elimination).  Therefore each product-factor (aka &quot;smart factor&quot; in other uses of the language) represent both the factors as well as the sequencing of cliques in that branch.  This process repeats recursively from the root down to the leaves.  The leaves of the tree have no further reduced product factors condensing child cliques below, and therefore sparse factor fragments can be computed to start the upward belief propagation process.  More importantly, as belief propagation progresses up the tree, upward belief messages (on clique separators) capture the same structure as the densely connected Bayes net but each clique in the Bayes tree still only contains sparse fragments from the original factor graph.  The structure of the tree (combined parent-child relationships) encodes the same information as the product-factor conditionals!</p><h2 id="Initialization-on-the-Tree"><a class="docs-heading-anchor" href="#Initialization-on-the-Tree">Initialization on the Tree</a><a id="Initialization-on-the-Tree-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization-on-the-Tree" title="Permalink"></a></h2><p>It more challenging but possible to initialize all variables in a factor graph through belief propagation on the Bayes tree.</p><p>As a thought experiment: Wouldn&#39;t it be awesome if we could compile the upsolve as a symbolic process only, and only assign numerical values once during a single downsolve procedure.  The origin of this idea comes from the realization that a complete upsolve on the Bayes (Junction) tree is very nearly the same thing finding good numerical initialization values for the factor graph.  If the up-init-solve can be performed as a purely symbolic process, it would greatly simplify numerical computations by deferring them to the down solve alone.</p><p>Trying to do initialization for real, we might want to replace up-init-symbolic operations with numerical equivalents.  Either way, it would be worth knowing what the equivalent numerical operations of a full up-init-solve of an uninitialized factor graph would look like.</p><p>In general, if a clique can not be initialized based on information from lower down in that branch of the tree; more information is need from the parent.  In the Gaussian (more accurately the congruent factor) case, all information lower down in the branch–-i.e. the relationships between variables in parent–-can be summarized by a new conditional product-factor that is computed with the probabilistic chain rule.  To restate, the process of squashing the Bayes tree branch back down into a Bayes net, is effectively the the chain rule process used in variable elimination.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Question, are cascading up and down solves are required if you do not use eliminated factor conditionals in parent cliques.</p></div></div><h3 id="Gaussian-only-special-case"><a class="docs-heading-anchor" href="#Gaussian-only-special-case">Gaussian-only special case</a><a id="Gaussian-only-special-case-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-only-special-case" title="Permalink"></a></h3><p>Elimination of variables and factors using chain rule reduction is a special case of belief propagation, and thus far only the reduction of congruent beliefs (such as Gaussian) is known.</p><p>These computations can be parallelized depending on the conditional independence structure of the Bayes tree – separate branches are effectively separate chain rule instances.  This is precisely the same process exploited by multi-frontal QR matrix factorization.</p><p>On the down solve the conditionals–-from eliminated chains of previously eliminated variables and factors–-can be used for inference directly in the parent.  </p><p>See node x1 to x3 in IncrementalInference issue 464. It does not branch or provide additional prior information. so it is collapsed into one factor between x1 and x3, solved in the root and the individual variable can be solved by inference.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Question, what does the Jacobian in Gaussian only case mean with regard to a symbolic upsolve?</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bayestreePrinciples/">« Bayes (Junction) tree</a><a class="docs-footer-nextpage" href="../../concepts/mmisam_alg/">Multimodal iSAM Algorithm »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 22 February 2021 13:42">Monday 22 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
