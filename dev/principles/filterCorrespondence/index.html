<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filters vs. Graphs · Caesar.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Caesar.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Welcome</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><a class="tocitem" href="../../concepts/why_nongaussian/">Gaussian vs. Non-Gaussian</a></li><li><a class="tocitem" href="../../installation_environment/">Installation</a></li><li><a class="tocitem" href="../../concepts/using_julia/">Using Julia</a></li><li><a class="tocitem" href="../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../concepts/concepts/">Initial Concepts</a></li><li><a class="tocitem" href="../../concepts/building_graphs/">Building Graphs</a></li><li><a class="tocitem" href="../../concepts/solving_graphs/">Solving Graphs</a></li><li><a class="tocitem" href="../../concepts/interacting_fgs/">Interact w Graphs</a></li><li><a class="tocitem" href="../../concepts/dataassociation/">Multi-Modal/Hypothesis</a></li><li><a class="tocitem" href="../../concepts/parallel_processing/">Parallel Processing</a></li><li><a class="tocitem" href="../../concepts/using_manifolds/">Using Manifold</a></li><li><a class="tocitem" href="../../examples/parametric_solve/">[DEV] Parametric Solve</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/examples/">Caesar Examples</a></li><li><a class="tocitem" href="../../examples/basic_continuousscalar/">Canonical 1D Example</a></li><li><a class="tocitem" href="../../examples/basic_slamedonut/">Underconstrained Range-only</a></li><li><a class="tocitem" href="../../examples/basic_hexagonal2d/">Hexagonal 2D SLAM</a></li><li><a class="tocitem" href="../../examples/interm_fixedlag_hexagonal/">Fixed-Lag Solving 2D</a></li><li><a class="tocitem" href="../../examples/deadreckontether/">Dead Reckon Tether</a></li></ul></li><li><span class="tocitem">Graph Library</span><ul><li><a class="tocitem" href="../../examples/canonical_graphs/">Canonical Generators</a></li><li><a class="tocitem" href="../../concepts/entry_data/">Entry=&gt;Data Blob</a></li><li><a class="tocitem" href="../../concepts/available_varfacs/">Variables/Factors</a></li><li><a class="tocitem" href="../../concepts/flux_factors/">Flux (NN) Factors</a></li><li><a class="tocitem" href="../../examples/using_images/">Images and AprilTags</a></li></ul></li><li><span class="tocitem">Visualization</span><ul><li><a class="tocitem" href="../../install_viz/">Installing Viz</a></li><li><a class="tocitem" href="../../concepts/2d_plotting/">Plotting (2D)</a></li><li><a class="tocitem" href="../../concepts/arena_visualizations/">Visualization (3D)</a></li></ul></li><li><span class="tocitem">Middlewares</span><ul><li><a class="tocitem" href="../../examples/using_ros/">ROS Middleware</a></li><li><a class="tocitem" href="../../concepts/compile_binary/">Compile Binaries</a></li><li><a class="tocitem" href="../../concepts/zero_install/">Zero Install Solution</a></li><li><a class="tocitem" href="../../concepts/multisession/">Multi-session/agent Solving</a></li><li><a class="tocitem" href="../../concepts/multilang/">Multi-Language Support</a></li></ul></li><li><span class="tocitem">How to Expand?</span><ul><li><a class="tocitem" href="../../caesar_framework/">Pkg Framework</a></li><li><a class="tocitem" href="../../examples/custom_variables/">Custom Variables</a></li><li><a class="tocitem" href="../../examples/basic_definingfactors/">Custom Prior Factor</a></li><li><a class="tocitem" href="../../examples/custom_relative_factors/">Custom Relative Factor</a></li><li><a class="tocitem" href="../../examples/custom_factor_features/">Important Factor Features</a></li><li><a class="tocitem" href="../../examples/adding_variables_factors/">Variable/Factor Considerations</a></li><li><a class="tocitem" href="../../func_ref/">More Functions</a></li></ul></li><li><span class="tocitem">Principles</span><ul><li class="is-active"><a class="tocitem" href>Filters vs. Graphs</a><ul class="internal"><li><a class="tocitem" href="#Correspondence-with-Kalman-Filtering?"><span>Correspondence with Kalman Filtering?</span></a></li><li><a class="tocitem" href="#Joint-Probability-and-Chapman-Kolmogorov"><span>Joint Probability and Chapman-Kolmogorov</span></a></li><li><a class="tocitem" href="#The-Target-Tracking-Problem-(Conventional-Filtering)"><span>The Target Tracking Problem (Conventional Filtering)</span></a></li><li><a class="tocitem" href="#Beyond-Filtering"><span>Beyond Filtering</span></a></li><li><a class="tocitem" href="#Anecdotal-Example-(EKF-SLAM-/-MSC-KF)"><span>Anecdotal Example (EKF-SLAM / MSC-KF)</span></a></li></ul></li><li><a class="tocitem" href="../approxConvDensities/">Generic Convolutions</a></li><li><a class="tocitem" href="../multiplyingDensities/">Multiplying Functions (.py)</a></li><li><a class="tocitem" href="../bayestreePrinciples/">Bayes (Junction) tree</a></li><li><a class="tocitem" href="../initializingOnBayesTree/">Advanced Bayes Tree Topics</a></li><li><a class="tocitem" href="../../concepts/mmisam_alg/">Non-Gaussian Algorithm</a></li></ul></li><li><span class="tocitem">Developer Zone</span><ul><li><a class="tocitem" href="../../dev/wiki/">Wiki Pointers</a></li><li><a class="tocitem" href="../../examples/legacy_deffactors/">Legacy Factors</a></li><li><a class="tocitem" href="../interm_dynpose/">Creating DynPose Factor</a></li><li><a class="tocitem" href="../../dev/known_issues/">Known Issue List</a></li><li><a class="tocitem" href="../../dev/internal_fncs/">Internal Functions</a></li></ul></li><li><span class="tocitem">Literature</span><ul><li><a class="tocitem" href="../../refs/literature/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Principles</a></li><li class="is-active"><a href>Filters vs. Graphs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Filters vs. Graphs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/docs/src/principles/filterCorrespondence.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Build-your-own-(Bayes)-Filter"><a class="docs-heading-anchor" href="#Build-your-own-(Bayes)-Filter">Build your own (Bayes) Filter</a><a id="Build-your-own-(Bayes)-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Build-your-own-(Bayes)-Filter" title="Permalink"></a></h1><h2 id="Correspondence-with-Kalman-Filtering?"><a class="docs-heading-anchor" href="#Correspondence-with-Kalman-Filtering?">Correspondence with Kalman Filtering?</a><a id="Correspondence-with-Kalman-Filtering?-1"></a><a class="docs-heading-anchor-permalink" href="#Correspondence-with-Kalman-Filtering?" title="Permalink"></a></h2><p>A frequent discussion point is the correspondence between Kalman/particle/log-flow filtering strategies and factor graph formulations.  This section aims to shed light on the relationship, and to show that factor graph interpretations are a powerful generalization of existing filtering techniques.  The discussion follows a <em>build-your-own-filter</em> style and combines the <a href="https://www.juliarobotics.org/Caesar.jl/latest/principles/approxConvDensities/">Approximate Convolution</a> and <a href="https://www.juliarobotics.org/Caesar.jl/latest/principles/multiplyingDensities/">Multiplying Densities</a> pages as the required <strong>prediction</strong> and <strong>update</strong> cycle steps, respectively.  Using the steps described here, the user will be able to build fully-functional–-i.e. non-Gaussian–-(Bayes) filters.  </p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>A <a href="https://github.com/JuliaRobotics/Caesar.jl/blob/master/examples/basic/BayesFilter1D.jl">simple 1D predict correct Bayesian filtering example (using underlying convolution and product operations of the mmisam algorithm)</a> can be used as a rough template to familiarize yourself on the correspondence between filters and newer <em>graph-based</em> operations.</p></div></div><p>This page tries to highlight some of the reasons why using a factor graph approach (w/ Bayes/junction tree inference) in a incremental/fixed-lag/federated sense–-e.g. simultaneous localization and mapping (SLAM) approach–-has merit.  The described steps form part of the core operations used by the <a href="https://www.juliarobotics.org/Caesar.jl/latest/concepts/mmisam_alg/">multimodal incremental smoothing and mapping (mmisam)</a> algorithm.</p><p>Further topics on factor graph (and Bayes/junction tree) inference formulation, including how out-marginalization works is discussed separately as part of the <a href="https://www.juliarobotics.org/Caesar.jl/latest/principles/bayestreePrinciples/">Bayes tree description page</a>.  It is also worth reiterating <a href="https://juliarobotics.org/Caesar.jl/latest/concepts/concepts/#Why/Where-does-non-Gaussian-data-come-from?-1">the section on why do we even care about non-Gaussian</a> signal processing.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Coming soon, the steps described on this page will be fully accessible via <a href="https://www.juliarobotics.org/Caesar.jl/latest/concepts/multilang/#">multi-language interfaces (middleware)</a> – some of these interfaces already exist.</p></div></div><h3 id="Causality-and-Markov-Assumption"><a class="docs-heading-anchor" href="#Causality-and-Markov-Assumption">Causality and Markov Assumption</a><a id="Causality-and-Markov-Assumption-1"></a><a class="docs-heading-anchor-permalink" href="#Causality-and-Markov-Assumption" title="Permalink"></a></h3><p>WIP: Causal connection explanation:  How is the graph based method the same as Kalman filtering variants (UKF, EKF), including Bayesian filtering (PF, etc.), and the Hidden Markov Model (HMM) methodology.  </p><p>Furthermore, see below for connection to EKF-SLAM too.</p><h2 id="Joint-Probability-and-Chapman-Kolmogorov"><a class="docs-heading-anchor" href="#Joint-Probability-and-Chapman-Kolmogorov">Joint Probability and Chapman-Kolmogorov</a><a id="Joint-Probability-and-Chapman-Kolmogorov-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Probability-and-Chapman-Kolmogorov" title="Permalink"></a></h2><p>WIP; The high level task is to &quot;invert&quot; measurements Z give the state of the world Theta</p><h3 id="Maximum-Likelihood-vs.-Message-Passing"><a class="docs-heading-anchor" href="#Maximum-Likelihood-vs.-Message-Passing">Maximum Likelihood vs. Message Passing</a><a id="Maximum-Likelihood-vs.-Message-Passing-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Likelihood-vs.-Message-Passing" title="Permalink"></a></h3><p>WIP; This dicussion will lead towards Bayesian Networks (Pearl) and Bayes Trees (Kaess et al., Fourie et al.).</p><h2 id="The-Target-Tracking-Problem-(Conventional-Filtering)"><a class="docs-heading-anchor" href="#The-Target-Tracking-Problem-(Conventional-Filtering)">The Target Tracking Problem (Conventional Filtering)</a><a id="The-Target-Tracking-Problem-(Conventional-Filtering)-1"></a><a class="docs-heading-anchor-permalink" href="#The-Target-Tracking-Problem-(Conventional-Filtering)" title="Permalink"></a></h2><p>Consider a common example, two dimensional target tracking, where a projectile transits over a tracking station using various sensing technologies <a href="https://www.juliarobotics.org/Caesar.jl/latest/refs/literature/">[Zarchan 2013]</a>.  Position and velocity estimates of the target</p><h3 id="Prediction-Step-using-a-Factor-Graph"><a class="docs-heading-anchor" href="#Prediction-Step-using-a-Factor-Graph">Prediction Step using a Factor Graph</a><a id="Prediction-Step-using-a-Factor-Graph-1"></a><a class="docs-heading-anchor-permalink" href="#Prediction-Step-using-a-Factor-Graph" title="Permalink"></a></h3><p>Assume a constant velocity model from which the estimate will be updated through the measurement model described in the next section.  A constant velocity model is taken as (cartesian)</p><p class="math-container">\[\frac{dx}{dt} = 0 + \eta_x\\
\frac{dy}{dt} = 0 + \eta_y\]</p><p>or polar coordinates</p><p class="math-container">\[\frac{d\rho}{dt} = 0 + \eta_{\rho}\\
\frac{d\theta}{dt} = 0 + \eta_{\theta}.\]</p><p>In this example, noise is introduced as an affine slack variable <code>\eta</code>, but could be added as any part of the process model:</p><p class="math-container">\[\eta_j \sim p(...)\]</p><p>where <code>p</code> is any allowable noise probability density/distribution model – discussed more in the next section.</p><p>After integration (assume zeroth order) the associated residual function can be constructed:</p><p class="math-container">\[\delta_i (\theta_{k}, \theta_{k-1}, \frac{d \theta_k}{dt}; \Delta t) = \theta_{k} - (\theta_{k-1} + \frac{d \theta_k}{dt} \Delta t)\]</p><p>Filter prediction steps are synonymous with a binary factor (conditional likelihood) between two variables where a prior estimate from one variable is projected (by means of a convolution) to the next variable.  The <a href="https://www.juliarobotics.org/Caesar.jl/latest/principles/approxConvDensities/">convolutional principle page</a> describes a more detailed example on how a convolution can be computed. </p><h3 id="Measurement-Step-using-a-Factor-Graph"><a class="docs-heading-anchor" href="#Measurement-Step-using-a-Factor-Graph">Measurement Step using a Factor Graph</a><a id="Measurement-Step-using-a-Factor-Graph-1"></a><a class="docs-heading-anchor-permalink" href="#Measurement-Step-using-a-Factor-Graph" title="Permalink"></a></h3><p>The measurement update is a product operation of infinite functional objects (probability densities)</p><p class="math-container">\[p(X_k | X_{k-1}, Z_a, Z_b) \approx p(X_k | X_{k-1}, Z_a) \times p(X_k | Z_b),\]</p><p>where <code>Z_.</code> represents conditional information for two beliefs on the same variable.  The product of the two functional estimates (beliefs) are multiplied by a stochastic algorithm described in more detail <a href="https://www.juliarobotics.org/Caesar.jl/latest/principles/multiplyingDensities/">on the multiplying functions page</a>.</p><p>Direct state observations can be added to the factor graph as prior factors directly on the variables.  An illustration of both predictions (binary likelihood process model) and direct observations (measurements) is presented:</p><p align="center">
<img src="https://user-images.githubusercontent.com/6412556/68166954-e45e4180-ff5b-11e9-91cb-0741d90a0c02.png" width="480" border="0" />
</p><p>Alternatively, indirect measurements of the state variables are should be modeled with the most sensible function</p><p class="math-container">\[y = h(\theta, \eta)\\
\delta_j(\theta_j, \eta_j) = \ominus h_j(\theta_j, \eta_j) \oplus y_j,\]</p><p>which approximates the underlying (on-manifold) stochastics and physics of the process at hand.  The measurement models can be used to project belief through a measurement function, and should be recognized as a standard representation for a <a href="https://en.wikipedia.org/wiki/Hidden_Markov_model">Hidden Markov Model (HMM)</a>:</p><p align="center">
<img src="https://user-images.githubusercontent.com/6412556/71652397-105c3000-2d1d-11ea-92bc-282ddbe3eabc.png" width="480" border="0" />
</p><h2 id="Beyond-Filtering"><a class="docs-heading-anchor" href="#Beyond-Filtering">Beyond Filtering</a><a id="Beyond-Filtering-1"></a><a class="docs-heading-anchor-permalink" href="#Beyond-Filtering" title="Permalink"></a></h2><p>Consider a multi-sensory system along with data transmission delays, variable sampling rates, etc.;  when designing a filtering system to track one or multiple targets, it quickly becomes difficult to augment state vectors with the required state and measurement histories.  In contrast, the factor graph as a language allows for heterogeneous data streams to be combined in a common inference framework, and is <a href="http://www.juliarobotics.org/Caesar.jl/latest/concepts/building_graphs/">discussed further in the building distributed factor graphs section</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Factor graphs are constructed along with the evolution of time which allows the mmisam inference algorithm to resolve variable marginal estimates both forward and backwards in time.  Conventional filtering only allows for forward-backward &quot;smoothing&quot; as two separate processes.  When inferring over a factor graph, all variables and factors are considered simultaneously according the topological connectivity irrespective of when and where which measurements were made or communicated – as long as the factor graph (probabilistic model) captures the stochastics of the situation with sufficient accuracy.  </p></div></div><blockquote><p>TODO: Multi-modal (belief) vs. multi-hypothesis – see thesis work on multimodal solutions in the mean time.</p></blockquote><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Mmisam allows for parametric, non-parametric, or intensity noise models which can be incorporated into any differentiable residual function.</p></div></div><h2 id="Anecdotal-Example-(EKF-SLAM-/-MSC-KF)"><a class="docs-heading-anchor" href="#Anecdotal-Example-(EKF-SLAM-/-MSC-KF)">Anecdotal Example (EKF-SLAM / MSC-KF)</a><a id="Anecdotal-Example-(EKF-SLAM-/-MSC-KF)-1"></a><a class="docs-heading-anchor-permalink" href="#Anecdotal-Example-(EKF-SLAM-/-MSC-KF)" title="Permalink"></a></h2><p>WIP: Explain how this method is similar to EKF-SLAM and MSC-KF...</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../func_ref/">« More Functions</a><a class="docs-footer-nextpage" href="../approxConvDensities/">Generic Convolutions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Tuesday 29 March 2022 06:56">Tuesday 29 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
